from QR import *

def test_gram_schmidt():
    matrix_a = [[1, 1, 1],[1, 1, 0],[1, 0, 0]]
    matrix_b = [[1, 2, 1], [2, 3, 3], [4, 1, 2]]
    assert gram_schmidt_stable(matrix_a) == [[[0.7071067811865475, 0.7071067811865475, 0.0], [0.4082482904638632, -0.40824829046386296, 0.8164965809277261], [-0.5773502691896257, 0.5773502691896258, 0.5773502691896257]], 
                                               [[1.414213562373095, 0, 0], [0.7071067811865475, 1.2247448713915892, 0], [0.7071067811865475, 0.4082482904638632, 1.1547005383792515]]]
    assert gram_schmidt_stable(matrix_b) == [[[-0.4082, -0.8165, -0.4082], [0.1231, -0.4924, 0.8612], [0.9045, -0.3015, -0.3015]], [[2.4495, 0, 0], [-4.4907, 1.354, 0], [-3.266, 1.7233, 2.7136]]]
    
def test_orthonormal_vectors():
    matrix_a = [[1, 1, 1], [1, 1, 0], [1, 0, 0]]
    matrix_b = [[1, 2, 1], [2, 3, 3], [4, 1, 2]]
    assert orthonormal_vectors(matrix_a) == [[0.7071067811865475, 0.7071067811865475, 0.0], [0.4082482904638632, -0.40824829046386296, 0.8164965809277261], [-0.5773502691896257, 0.5773502691896258, 0.5773502691896257]]
    assert orthonormal_vectors(matrix_b) == [[-0.4082, -0.8165, -0.4082], [0.1231, -0.4924, 0.8612], [0.9045, -0.3015, -0.3015]]
    
def test_householder_qr():
    matrix_a = [[1, 1, 1],[1, 1, 0],[1, 0, 0]]
    matrix_b = [[1, 2, 1], [2, 3, 3], [4, 1, 2]]
    assert householder_qr(matrix_a) == [[[0.7071067811865475, 0.7071067811865475, 0.0], [0.4082482904638632, -0.40824829046386296, 0.8164965809277261], [-0.5773502691896257, 0.5773502691896258, 0.5773502691896257]], 
                                               [[1.414213562373095, 0, 0], [0.7071067811865475, 1.2247448713915892, 0], [0.7071067811865475, 0.4082482904638632, 1.1547005383792515]]]
    assert householder_qr(matrix_b) == [[[-0.4082, -0.8165, -0.4082], [0.1231, -0.4924, 0.8612], [0.9045, -0.3015, -0.3015]], [[2.4495, 0, 0], [-4.4907, 1.354, 0], [-3.266, 1.7233, 2.7136]]]